
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>PND4</title>
  <meta name="author" content="">

  
  <meta name="description" content="_This time I power-walk you through each command to install Gentoo (using a Hardened Stage 3 toolchain). I used this same set of commands, with a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.pnd4.net/blog/page/6">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="PND4" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Coda:400,800' rel='stylesheet' type='text/css'>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">PND4</a></h1>
  
    <h2>/dev/notes</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.pnd4.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/profile/">Profile</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/28/gentoo-walkthru/">Hardened Gentoo Installation</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-28T19:31:49-07:00" pubdate data-updated="true">Aug 28<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="center" src="/images/2012-08-29-gentoo-walkthru/screenshot-082912-035809.png"></p>

<p>_This time I power-walk you through each command to install Gentoo (using a Hardened Stage 3 toolchain). I used this same set of commands, with a little modification of course, to install Gentoo onto my desktop. My hardware configuration is very unlikely the same as yours; adjust accordingly, otherwise these instructions should be all you need to tackle one of the hardest distro&rsquo;s to install (by reputation). _</p>

<p>_.. Before you tl;dr, realize that even though the process is long and gruesome, there&rsquo;s so much to learn by just even trying, so do not dispair. There&rsquo;s tons of resources out there! Good luck.
_</p>

<p><strong>Installing Hardened Gentoo with Xorg.</strong></p>

<p>Boot live media</p>

<p>Disable network manager if running</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># /etc/init.d/NetworkManager stop</span></code></pre></td></tr></table></div></figure>


<p>Connect to wireless</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># iwconfig wlan0 essid NETGEAR key s:yourmom
</span><span class='line'># ifconfig wlan0 192.168.1.100 netmask 255.255.255.0
</span><span class='line'># route add default gw 192.168.1.254
</span><span class='line'># ping -c 3 www.google.com</span></code></pre></td></tr></table></div></figure>


<p>Set root password</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># passwd root</span></code></pre></td></tr></table></div></figure>


<p>[now we switch to our remote computer]</p>

<p>SSH into the box we&rsquo;re install Gentoo onto</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ssh 192.168.1.100 -l root</span></code></pre></td></tr></table></div></figure>


<p>Create partitions</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># fdisk /dev/sda</span></code></pre></td></tr></table></div></figure>


<p>They should look something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/dev/sda1 1G Linux /boot
</span><span class='line'> /dev/sda2 4G Linux Swap /swap
</span><span class='line'> /dev/sda3 Rest Linux /root</span></code></pre></td></tr></table></div></figure>


<p>Create filesystems</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># mkfs.ext2 /dev/sda1 -L boot
</span><span class='line'># mkswap /dev/sda2 -L swap && swapon /dev/sda2
</span><span class='line'># mkfs.ext2 -j /dev/sda3 -L root</span></code></pre></td></tr></table></div></figure>


<p>Mount filesystems for install</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># mount /dev/sda3 /mnt/gentoo
</span><span class='line'># mkdir /mnt/gentoo/boot
</span><span class='line'># mount /dev/sda1 /mnt/gentoo/boot</span></code></pre></td></tr></table></div></figure>


<p>Download and extract latest stage 3</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cd /mnt/gentoo
</span><span class='line'># wget http://ftp.ucsb.edu/pub/mirrors/linux/gentoo/releases/amd64/current-stage3/hardened/stage3-amd64-hardened-20120621.tar.bz2
</span><span class='line'># tar xjpf stage3-*</span></code></pre></td></tr></table></div></figure>


<p>Download and extract latest portage snapshot</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cd /mnt/gentoo/usr
</span><span class='line'># wget http://ftp.ucsb.edu/pub/mirrors/linux/gentoo/releases/snapshots/current/portage-latest.tar.bz2
</span><span class='line'># tar xjf portage-latest.tar.bz2</span></code></pre></td></tr></table></div></figure>


<p>Mount relevant directories and chroot into new environment</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cd /
</span><span class='line'># mount -t proc proc /mnt/gentoo/proc
</span><span class='line'># mount --rbind /dev /mnt/gentoo/dev
</span><span class='line'># cp -L /etc/resolv.conf /mnt/gentoo/etc
</span><span class='line'># chroot /mnt/gentoo /bin/bash
</span><span class='line'># env-update && source /etc/profile</span></code></pre></td></tr></table></div></figure>


<p>Configure time zone</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ln -sf /usr/share/zoneinfo/America/Los_Angeles /etc/localtime
</span><span class='line'># echo "America/Los_Angeles" > /etc/timezone
</span><span class='line'># date</span></code></pre></td></tr></table></div></figure>


<p>Configure hostname and domain name</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># nano /etc/hosts
</span><span class='line'># nano /etc/conf.d/hostname
</span><span class='line'># hostname blackbox
</span><span class='line'># hostname -f</span></code></pre></td></tr></table></div></figure>


<p>Download and compile your kernel</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># emerge -av hardened-sources linux-firmware
</span><span class='line'># cd /usr/src/linux
</span><span class='line'># make menuconfig</span></code></pre></td></tr></table></div></figure>


<p>Make and install kernel and modules</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># make -j2
</span><span class='line'># make modules_install
</span><span class='line'># cp arch/x86_64/boot/bzImage /boot/kernel
</span><span class='line'># echo 'modules="ath9k_htc"' >> /etc/conf.d/modules</span></code></pre></td></tr></table></div></figure>


<p>Configure fstab</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># nano /etc/fstab</span></code></pre></td></tr></table></div></figure>


<p> /dev/sda1 /boot ext2 noauto,noatime 1 2
 /dev/sda2 none swap swap sw 0 0
 /dev/sda3 / ext3 noatime 0 1
 /dev/sr0 /mnt/cdrom auto 0 0</p>

<p>Add sshd as a default service</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># rc-update add sshd default</span></code></pre></td></tr></table></div></figure>


<p>Set the root password</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># passwd root</span></code></pre></td></tr></table></div></figure>


<p>Install some recommended tools (syslog-ng, vixie-cron, wireless-tools, wpa_supplicant)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># emerge -av syslog-ng vixie-cron wireless-tools wpa_supplicant
</span><span class='line'># rc-update add syslog-ng default
</span><span class='line'># rc-update add vixie-cron default</span></code></pre></td></tr></table></div></figure>


<p>Install and configure bootloader</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># emerge -av grub
</span><span class='line'># nano /boot/grub/grub.conf
</span><span class='line'>**grub.conf**
</span><span class='line'>default 0
</span><span class='line'>timeout 10
</span><span class='line'>title Gentoo
</span><span class='line'>root (hd0,0)
</span><span class='line'>kernel /boot/kernel root=/dev/sda3 video=800x600
</span><span class='line'>
</span><span class='line'># grub
</span><span class='line'>>root (hd0,0)
</span><span class='line'>>setup (hd0)
</span><span class='line'>>quit</span></code></pre></td></tr></table></div></figure>


<p>Exit chroot, umount everything, and reboot</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># exit
</span><span class='line'># umount -l /mnt/gentoo/dev{/shm,/pts,}
</span><span class='line'># umount -l /mnt/gentoo{/proc,/boot,}
</span><span class='line'># reboot</span></code></pre></td></tr></table></div></figure>


<p>Add new user</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># useradd -g users -G lp,wheel,audio,cdrom,portage,cron -m somefag
</span><span class='line'># passwd somefag</span></code></pre></td></tr></table></div></figure>


<p>Sort mirrors</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># emerge mirrorselect
</span><span class='line'># mirrorselect -i -o >> /etc/portage/make.conf
</span><span class='line'># mirrorselect -i -r -o >> /etc/portage/make.conf</span></code></pre></td></tr></table></div></figure>


<p>Configure stuff in /etc/portage/make.conf</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MAKEOPTS="-j2"
</span><span class='line'>USE= [fill in]
</span><span class='line'>CFLAGS="-O2 -march=native -pipe"
</span><span class='line'>VIDEO_CARDS="radeon"
</span><span class='line'>INPUT_DEVICES="evdev synaptics"</span></code></pre></td></tr></table></div></figure>


<p>Uncomment and generate locales you&rsquo;re going to use</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># nano /etc/locale.gen
</span><span class='line'># locale-gen</span></code></pre></td></tr></table></div></figure>


<p>Re-emerge world, libtool</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># emerge -vuD --newuse world
</span><span class='line'># emerge --oneshot libtool</span></code></pre></td></tr></table></div></figure>


<p>Update config (do not overwrite the files you&rsquo;ve done your own editing to)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># dispatch-conf</span></code></pre></td></tr></table></div></figure>


<p><em>(Optional, if Perl or Python got updated, but doesnt hurt)</em></p>

<p>Run perl-cleaner and python-updater</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># perl-cleaner all
</span><span class='line'># python-updater</span></code></pre></td></tr></table></div></figure>


<p>Install xorg</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># emerge -av xorg-server
</span><span class='line'># env-update && source /etc/profile</span></code></pre></td></tr></table></div></figure>


<p>and.. voilà!</p>

<p><em>Continue by customizing your install with a browser, file manager, window manager, or be lazy and just get a whole desktop environment. Have fun making any necessary tweaks to file&rsquo;s we&rsquo;ve already used, like make.conf USE flags, kernel configuration, bootloader.. but be happy, if you&rsquo;ve got this far, you&rsquo;ve got a working system.</em></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/26/fresh-easys-beer-selection/">Fresh & Easy&#8217;s Beer Selection</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-26T13:34:08-07:00" pubdate data-updated="true">Aug 26<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="center" src="/images/2012-08-26-fresh-easys-beer-selection/kona_brewing_company_beers-02.jpg"></p>

<p>If you ever find yourself frequenting a Fresh n&#8217; Easy market like I have, hopefully you try some of the beer&rsquo;s they rotate into the sale&rsquo;s page..  I&rsquo;ve, more often than not, been surprised by their selection which ranges from local brews, imports, and the usual commodity of domestics. While theres nothing wrong with grabbing your favorite, a lot of us out there like to take risks and broaden our horizons. Here&rsquo;s a short listing of a few randoms I&rsquo;ve tried in the last month or two, and ratings to go with them.</p>

<p>9 / 10 &ndash; Kona Brewing Co. &lsquo;Longboard Island Lager&rsquo;</p>

<p>9 / 10 &ndash; Leffe: &lsquo;Leffe Blonde&rsquo;</p>

<p>3 / 10 &ndash; Hopper Whitman: &lsquo;Belgian White&rsquo;</p>

<p>7 / 10 &ndash; Racer5</p>

<p>Hopefully this helps someone pacing up and down the cooler isle trying to make their selection, so they can get to where they need to be and back to loving life.</p>

<p>Thanks goes out to Adriel, John, and Fresh &amp; Easy for making this post possible.. <em>hiccup</em></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/21/systemd/">Migrating to Systemd</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-21T10:37:26-07:00" pubdate data-updated="true">Aug 21<span>st</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="center" src="/images/2012-08-21-systemd/08202012-105537pm.png"></p>

<p><em>Last night I stumbled upon systemd, freedesktop.org&rsquo;s set of services and scripts for the Linux System Base (LSB) to bring it up to userspace. Making good use of parallelization to beat its predecessor, sysvinit, it boots my laptop up in less than 10 seconds from grub to login-prompt and Im not even using a Solid State Drive (SSD).. Needless to say, I&rsquo;ve been happy with its performance but Ive only been running it on my system for less than 24-hrs and there&rsquo;s still some tweaks need to be made to make a clean and full transition. I really hope more distro&rsquo;s make the migration natively, and it seems that my sentiments are shared in the community.</em></p>

<p><em>Without further ado, here are my notes:</em></p>

<p>Lets begin by installing the <strong>systemd</strong> package</p>

<p>Manually add <strong>init=/bin/systemd </strong>to your grub config.</p>

<p>Setup native systemd configuration files</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># echo "your-hostname" > **/etc/hostname**</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>**/etc/vconsole.conf**
</span><span class='line'>KEYMAP=us
</span><span class='line'>FONT=lat9w-16
</span><span class='line'>FONT_MAP=8859-1_to_uni</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>**/etc/locale.conf**
</span><span class='line'>LANG=en_US.UTF-8
</span><span class='line'>LC_COLLATE=C</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># echo "America/Los_Angeles" > **/etc/timezone**</span></code></pre></td></tr></table></div></figure>


<p>Once the previous steps are complete, you&rsquo;re all clear to reboot. Hopefully all went well and you&rsquo;ll be able to see some drastic speed improvements over sysV. Now all thats left is some optional steps to stay in good, proper form and possibly tweaking of services like syslog-ng which has been deprecated in favor of journalctl (which ships with systemd).</p>

<p>[Optional] By default, running a syslog daemon is no longer required. To read the log, use:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># journalctl</span></code></pre></td></tr></table></div></figure>


<p>The journal writes to <code>/run/systemd/journal</code>, meaning logs will be lost on reboot. For non-volatile logs, create <code>/var/log/journal/</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># mkdir /var/log/journal/</span></code></pre></td></tr></table></div></figure>


<p>[Optional] Replace acpid with systemd mechanisms by uncommenting these from /etc/systemd/logind.conf&#8220;</p>

<ul>
<li><p><strong><code>HandlePowerKey</code></strong> : Power off the system when the power button is pressed</p></li>
<li><p><strong><code>HandleSleepKey</code></strong> : Suspend the system when the sleep key is pressed</p></li>
<li><p><strong><code>HandleLidSwitch</code></strong> : Suspend the system when the laptop lid is closed</p></li>
</ul>


<p>[Optional] After a successful reboot, you can clean up by</p>

<ul>
<li><p>removing packages pertaining to sysV (i.e.<strong> sysvinit</strong>,<strong> initscripts</strong>)</p></li>
<li><p>remove the <strong>init=/bin/systemd </strong>from your grub.cfg if you used the <strong>systemd-sysvcompat</strong> transitional package.</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/13/x11-over-ssh-tunnel/">X11 Over SSH Tunnel</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-13T09:05:07-07:00" pubdate data-updated="true">Aug 13<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="center" src="/images/2012-08-13-x11-over-ssh-tunnel/openssh2.gif"></p>

<h2>Conventions</h2>

<ul>
<li><p>Server &ndash; aka headless. Where X apps will be run on.</p></li>
<li><p>Client &ndash; aka laptop. Where apps will be shown.</p></li>
</ul>


<h2>Setting up the Server:</h2>

<p>Start by running sshd and configuring /etc/ssh/sshd_config</p>

<ul>
<li><p>Enable the <strong>AllowTcpForwarding</strong> option in <code>ssh**d**_config</code> on the <strong>server</strong>.</p></li>
<li><p>Enable the <strong>X11Forwarding</strong> option in <code>ssh**d**_config</code> on the <strong>server</strong>.</p></li>
<li><p>Set the <strong>X11DisplayOffset</strong> option in <code>ssh**d**_config</code> on the <strong>server</strong> to 10.</p></li>
<li><p>Enable the <strong>X11UseLocalhost</strong> option in <code>ssh**d**_config</code> on the <strong>server</strong>.</p></li>
</ul>


<p>Restart the server</p>

<p>Check /etc/hosts and make sure it has been configured with correct hostnames and IPs.</p>

<h2>Setting up the Client</h2>

<p>Configure /etc/ssh/ssh_config</p>

<ul>
<li><p>Enable the <strong>ForwardX11</strong> option in <code>ssh_config</code> on the <strong>client</strong>.</p></li>
<li><p>Or.. just use &ldquo;ssh -X&rdquo; [or -Y for X11 Trusted Forwarding] when you ssh into the server (for security)</p></li>
</ul>


<h2>Testing</h2>

<p>SSH into the server with &ldquo;ssh -X <a href="&#109;&#97;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#117;&#115;&#101;&#x72;&#64;&#49;&#x30;&#46;&#48;&#46;&#48;&#46;&#x31;">&#x75;&#x73;&#101;&#x72;&#64;&#x31;&#48;&#46;&#x30;&#46;&#x30;&#x2e;&#49;</a>&rdquo; and then run an X application such as xeyes, xterm, xclock, et cetera.. and enjoy.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/12/intel-graphics-and-early-kms/">Intel Graphics and early-KMS</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-12T10:28:59-07:00" pubdate data-updated="true">Aug 12<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="center" src="/images/2012-08-12-intel-graphics-and-early-kms/intel-logo.jpg"></p>

<p><em>Since just about every laptop or netbook I&rsquo;ve come into contact with has a Intel motherboard, I figured this topic should be covered to get the most out of your hardware, improve your overall experience, and simply enough, to do things right. I had to learn a little bit about KMS myself recently because sometimes things dont work out-of-the-box.</em></p>

<p><em>You want to enable KMS because it allows the kernel to set the native resolution on the frame-buffer. The effects of this are fast TTY-switching, enhanced 3D performance, and in some cases power-saving features.</em></p>

<p>In order to enable KMS on the Intel mobile platform some changes possibly have to be made to your Kernel, X installation, bootloader, and startup configuration.</p>

<p><strong>Kernel </strong>changes may only be necessary if you compiled your own (aka gentoo). In which case, simply enable the frame-buffer options:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Device Drivers --->
</span><span class='line'>  Graphics support --->
</span><span class='line'>    Support for frame buffer devices --->
</span><span class='line'>    (Disable all drivers, including VGA, Intel, nVidia, and ATI)
</span><span class='line'>
</span><span class='line'>    (Further down, enable basic console support. KMS uses this.)
</span><span class='line'>    Console display driver support --->
</span><span class='line'>      &lt;*>  Framebuffer Console Support
</span><span class='line'>
</span><span class='line'>    /dev/agpgart (AGP Support) --->
</span><span class='line'>      &lt;*>  Intel 440LX/BX/GX, I8xx and E7x05 chipset support
</span><span class='line'>      Direct Rendering Manager (XFree86 4.1.0 and higher DRI support) --->
</span><span class='line'>      &lt;*>  Intel 8xx/9xx/G3x/G4x/HD Graphics
</span><span class='line'>      [*]    Enable modesetting on intel by default</span></code></pre></td></tr></table></div></figure>


<p><strong>Xorg </strong>&rsquo;s only requirement is that we install it and the proper xf86-video-intel driver package.</p>

<p><strong>Bootloader</strong> changes are done so that our grub does not disable, use another driver, or try to set the resolution itself. Remember, we are letting the Kernel do this for us. so edit your /etc/default/grub and remove any of the following:</p>

<ul>
<li><p>Any &ldquo;nomodeset&rdquo;, &ldquo;i915.modeset=0&rdquo;, &ldquo;vga=&rdquo; or &#8221;video=&ldquo; at all present.</p></li>
<li><p>Anything that would enable another frame-buffer driver such as uvesafb.</p></li>
</ul>


<p><strong>Start-up configuration</strong> must reflect our efforts so that KMS is started early on in the process as possible to get the best effect. changes should be made to /etc/mkinitcpio.conf in Arch, or /etc/conf.d/modules in Gentoo to include the i915 module.</p>

<p>Finally regen your initial-ramdisk if you used one and your boot partition&rsquo;s GRUB config.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>## make initrd
</span><span class='line'># mkinitcpio -p linux
</span><span class='line'>## generate a GRUB config
</span><span class='line'># grub-mkconfig -o /boot/grub/grub.cfg</span></code></pre></td></tr></table></div></figure>


<p>Reboot and [hopefully] reap the fruits of all your hard work.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/7/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/5/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/05/03/pay-per-stream-bypass/">Pay-per-webcast?.. Srsly?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/20/optimizing-a-pogoplug/">Optimizing a Pogoplug</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/03/dual-monitor-toggle/">Dual-Monitor Toggle</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/pnd4">@pnd4</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'pnd4',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>









</body>
</html>
